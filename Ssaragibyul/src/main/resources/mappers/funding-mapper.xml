<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="fundingMapper">
<!--펀딩프로젝트 테이블  -->
	<resultMap type="Funding" id="fundingResultMap">
		<id property="projectNo" column="F_PROJECT_NO"></id>
		<result property="userId" column="USER_ID"></result>
		<result property="subjectName" column="SUBJECT"></result>
		<result property="productName" column="PRODUCT_NAME"></result>
		<result property="goalMoney" column="GOAL_MONEY"></result>
		<result property="sumMoney" column="SUM_MONEY"></result>
		<result property="optionPrice" column="OPTION_PRICE"></result>
		<result property="optionLimit" column="OPTION_LIMIT"></result>
		<result property="startDate" column="START_DATE"></result>
		<result property="finDate" column="FIN_DATE"></result>
		<result property="projectStory" column="PROJ_STORY"></result>
		<result property="productContent" column="PRODUCT_CONT"></result>
		<result property="warningIntro" column="WARNING_INTRO"></result>
		<result property="likeCount" column="LIKE_COUNT"></result>
		<result property="hitsCount" column="HITS_COUNT"></result>
		<result property="projectCode" column="PROJECT_CODE"></result>
		<result property="deleiveryDate" column="DELIVERY_DATE"></result>
		<result property="percent" column="PERCENT"></result>
		<result property="leftDate" column="LEFT_DATE"></result>
		<result property="count" column="COUNT"></result>
		<collection property="fundingFile" resultMap="fundingFileResultMap" />
		<collection property="member" resultMap="memberResultMap"></collection>
	</resultMap><!-- JOIN시 collection 필수  join 아니면 안쓰임-->
<!--펀딩 파일 테이블  -->
	<resultMap type="FundingFile" id="fundingFileResultMap">
		<id property="fileNo" column="FILE_NO"></id>
		<result property="videoUrl" column="FILE_VIDEO_URL"></result>
		<result property="fileMainName" column="FILE_MAIN_NAME"></result>
		<result property="fileMainSize" column="FILE_MAIN_SIZE"></result>
		<result property="fileMainPath" column="FILE_MAIN_PATH"></result>
		<result property="fileSub1Name" column="FILE_SUB1_NAME"></result>
		<result property="fileSub1Size" column="FILE_SUB1_SIZE"></result>
		<result property="fileSub1Path" column="FILE_SUB1_PATH"></result>
		<result property="fileSub2Name" column="FILE_SUB2_NAME"></result>
		<result property="fileSub2Size" column="FILE_SUB2_SIZE"></result>
		<result property="fileSub2Path" column="FILE_SUB2_PATH"></result>
		<result property="uploadTime" column="UPLOAD_TIME"></result>
		<result property="projectNo" column="F_PROJECT_NO"></result>
	</resultMap>
<!--펀딩 내역 테이블  -->
	<resultMap type="FundingLog" id="FundingLogResultMap">
		<id property="doFundNo" column="DOFUND_NO"></id>
		<result property="userId" column="USER_ID"></result>
		<result property="fundingPoint" column="FUNDING_POINT"></result>
		<result property="qunatity" column="QUNATITY"></result>
		<result property="fundDate" column="FUND_DATE"></result>
		<result property="cancleYn" column="CANCLE_YN"></result>
		<result property="projectNo" column="F_PROJECT_NO2"></result>
		<result property="receiverAddr" column="RECEIVER_ADDR"></result>
		<result property="receiverName" column="RECEIVER"></result>
		<result property="receiverPhone" column="RECEIVER_PHONE"></result>
		<result property="sponser" column="SPONSER"></result>
		<result property="count" column="COUNT"></result>
		<collection property="fundingProject" resultMap="fundingResultMap" />
	</resultMap>
<!-- 댓글 테이블  -->
	<resultMap type="Reply" id="FundingReplyResultMap">
		<id property="replyNo" column="COMM_NO"></id>
		<result property="no" column="F_PROJECT_NO"></result>
		<result property="userId" column="USER_ID"></result>
		<result property="nick" column="NICK_NAME"></result>
		<result property="contents" column="COMM_CONTENTS"></result>
		<result property="replyType" column="BOARD_TYPE"></result>
		<result property="enrollDate" column="ENROLL_DATE"></result>
	</resultMap>
<!-- 댓글 신고하기 테이블  -->
	<resultMap type="FundingReport" id="FundingReportResultMap">
		<id property="accuFundingNo" column="ACCU_FUND_NO"></id>
		<result property="userId" column="USER_ID"></result>
		<result property="reportCode" column="REPORT_CODE"></result>
		<result property="reportContent" column="REPORT_CONTENT"></result>
		<result property="processing" column="PROCESSING"></result>
		<result property="accusationDate" column="ACCUSATION_DATE"></result>
		<result property="projectNo" column="F_PROJECT_NO"></result>
	</resultMap>
<!-- 펀딩 좋아요 테이블  -->
	<resultMap type="FundingLike" id="FundingLikeResultMap">
		<id property="likeNo" column="LIKE_NO"></id>
		<result property="userId" column="USER_ID"></result>
		<result property="likeYn" column="LIKE_YN"></result>
		<result property="projectNo" column="F_PROJECT_NO"></result>
		<result property="count" column="COUNT"></result>
		<collection property="fundingProject" resultMap="fundingResultMap" />
	</resultMap>
	   <!--신고하기 관련 관리자  -->
	<resultMap type="ReportStat" id="reportStatResultMap">
      <result property="reportDay" column="REPORT_DAY"/>
      <result property="reportStatCount" column="REPORT_STAT_COUNT"/>
   </resultMap>
   
   	<resultMap type="Member" id="memberResultMap">
		<id property="userId" column="USER_ID"></id>
		<result property="userPw" column="USER_PW"></result>
		<result property="nickName" column="NICKNAME"></result>
		<result property="userName" column="USER_NAME"></result>
		<result property="userEmail" column="USER_EMAIL"></result>
		<result property="userPhone" column="USER_PHONE"></result>
		<result property="userAddr" column="USER_ADDR"></result>
		<result property="birthday" column="BIRTHDAY"></result>
		<result property="enrollDate" column="ENROLL_DATE"></result>
		<result property="withdrawDate" column="WITHDRAW_DATE"></result>
		<result property="mCode" column="M_CODE"></result>
		<result property="mngNo" column="MNG_NO"></result>
	</resultMap>


<!--펀딩 제안하기 입력 쿼리문 -->
	<insert id="insertFunding" parameterType="Funding">
		INSERT INTO
		FUNDING_PROJECT
		VALUES(SEQ_FUNDINGNO.NEXTVAL,#{userId},#{subjectName},#{productName},#{goalMoney},DEFAULT,#{optionPrice},#{optionLimit},SYSDATE,
		#{finDate},#{projectStory},#{productContent},#{warningIntro},DEFAULT,DEFAULT,0,#{deleiveryDate})
	</insert>
<!--펀딩 제안하기 할때 같이 작동하는 펀딩 파일 입력 쿼리문  -->
	<insert id="insertFundingFile" parameterType="FundingFile">
		INSERT INTO
		FUNDING_FILE
		VALUES(SEQ_FUNDINFILENO.NEXTVAL,#{videoUrl},#{fileMainName},NULL,'AAA',
		#{fileSub1Name},NULL,'BBB',#{fileSub2Name},NULL,'CCC',SYSTIMESTAMP,SEQ_FUNDINGNO.CURRVAL)
	</insert> <!-- namm 제외 경로, 사진사이즈 어디다 쓰는지 몰라서 일단 문자열(AAA,CCC) 처리 -->
<!--펀딩 참여하기 결제를 통해 펀딩 내역 추가 쿼리문  -->	
	<insert id="insertFundingLog" parameterType="FundingLog">
		INSERT INTO
		DO_FUNDING
		VALUES(SEQ_FUNDINGLOGNO.NEXTVAL,#{userId},#{fundingPoint},#{qunatity},SYSDATE,DEFAULT,#{projectNo}
		,#{receiverAddr},#{receiverName},#{receiverPhone})
	</insert>
	
<!-- 펀딩 리스트 상세 _ 하나만 출력 쿼리문 -->
	<select id="selectOne" resultMap="fundingResultMap">
		SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE, NICKNAME
        FROM
		(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       MEMBER.NICKNAME
		FROM FUNDING_PROJECT, MEMBER
		WHERE FUNDING_PROJECT.USER_ID = MEMBER.USER_ID)
		WHERE F_PROJECT_NO = #{projectNo}
	</select>
<!-- 펀딩 리스트 상세 (파일_사진)_ 하나만 출력 쿼리문 -->
	<select id="selectOneFile" resultMap="fundingFileResultMap">
		SELECT * FROM FUNDING_FILE WHERE F_PROJECT_NO = #{projectNo}
	</select>
<!-- 펀딩리스트 상세(좋아용!) -->
	<select id="selectOneLike" resultMap="FundingLikeResultMap">
		SELECT USER_ID FROM FUNDING_LIKE WHERE F_PROJECT_NO = #{projectNo}
	</select>
	
	<select id="selectOneCombine" resultMap="fundingFileResultMap">
	SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
		(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
	FROM FUNDING_PROJECT, FUNDING_FILE
	WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
	WHERE F_PROJECT_NO = #{projectNo}
	</select>
	
	

<!--펀링 리스트 메인 arrayList 전체 출력 쿼리문       백업용 남김 -->
<!-- 	<select id="selectFundingList" resultMap="fundingResultMap">
		SELECT * FROM FUNDING_PROJECT
		ORDER BY F_PROJECT_NO DESC
	</select> -->
	
<!--펀링 리스트 메인 + 파일(사진) 테이블 동시 JOIN 출력 쿼리문 _ 사용즁-->	
<!-- 	<select id="selectFundingList" resultMap="fundingResultMap">
		SELECT * FROM FUNDING_PROJECT, FUNDING_FILE
		WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC
	백업-->
	
	<!-- 퍼센트와 잔여일까지 계산 --> 
<select id="selectFundingList" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
WHERE LEFT_DATE > 0 AND PROJECT_CODE = 0
</select>  

<select id="selectFundingListEnd" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
WHERE LEFT_DATE<![CDATA[ <= ]]>0  AND PROJECT_CODE = 0
</select>  



	<select id="selectFundingList_Money" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 6 DESC)
WHERE <![CDATA[LEFT_DATE > 0 AND (ROWNUM >= 1 AND ROWNUM <= 6) ]]> AND PROJECT_CODE = 0
</select>  


	<select id="selectFundingList_Like" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 14 DESC)
WHERE <![CDATA[LEFT_DATE > 0 AND (ROWNUM >= 1 AND ROWNUM <= 6) ]]>  AND PROJECT_CODE = 0
</select>  




	<select id="selectFundingListEnd_Money" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 6 DESC)
WHERE <![CDATA[LEFT_DATE <= 0 AND (ROWNUM >= 1 AND ROWNUM <= 6) ]]>  AND PROJECT_CODE = 0
</select>  







	<select id="selectFundingListEnd_Like" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 14 DESC)
WHERE <![CDATA[LEFT_DATE <= 0 AND (ROWNUM >= 1 AND ROWNUM <= 6) ]]> AND PROJECT_CODE = 0
</select>  


<select id="selectAllFundProjectLimit" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
WHERE <![CDATA[LEFT_DATE > 0 AND (ROWNUM >= 1 AND ROWNUM <= 6) ]]>  AND PROJECT_CODE = 0
</select>  

<select id="selectAllFundProjectEndLimit" resultMap="fundingResultMap">
SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
WHERE <![CDATA[LEFT_DATE <= 0 AND (ROWNUM >= 1 AND ROWNUM <= 6)]]> AND PROJECT_CODE = 0
</select>  


<select id = "countSponserNumber" resultMap="FundingLogResultMap">
 SELECT COUNT(*) AS SPONSER FROM DO_FUNDING WHERE CANCLE_YN = 0 AND F_PROJECT_NO2 =  #{projectNo}
</select>



<select id = "selectFundingLogOne" resultMap="FundingLogResultMap">
	SELECT * FROM DO_FUNDING WHERE F_PROJECT_NO2 = #{projectNo} ORDER BY 1 DESC
</select>

	
<!--펀링 리스트 메인 파일(사진) arrayList 전체 출력 쿼리문   지금 안씀-->
	<select id="selectFundingFileList" resultMap="fundingFileResultMap">
		SELECT * FROM FUNDING_FILE
		ORDER BY F_PROJECT_NO DESC
	</select>
<!--펀딩 참여시 프로젝트_펀딩 테이블에 누적 금액 컬럼 금액 추가 +  하는 쿼리문  -->
	<update id="updateFundingAddMoney" parameterType="Funding"> 
		UPDATE FUNDING_PROJECT SET SUM_MONEY = (SUM_MONEY + #{sumMoney})
		WHERE
		F_PROJECT_NO = #{projectNo}
	</update> 
<!--펀딩 상세 페이지 조회수 증가 쿼리문  -->
	<update id="updateCount" parameterType="Funding">
		UPDATE FUNDING_PROJECT SET HITS_COUNT = HITS_COUNT + 1
		WHERE
		F_PROJECT_NO = #{projectNo }
	</update>
	
	
		
		
		
		
	
	<!-- 댓글 관련 insertReply -->
	<!-- 댓글 입력  -->
	<insert id="insertReply">
		INSERT INTO FUNDING_COMMENTS VALUES(SEQ_FUNDINGREPLYNO.NEXTVAL, #{no }, #{userId },#{nick }, #{contents }, '펀딩상세', SYSTIMESTAMP)
	</insert>
	<!-- 댓글 출력  -->
	<select id="selectReplyList" resultMap="FundingReplyResultMap">
		SELECT * FROM FUNDING_COMMENTS
		WHERE
		F_PROJECT_NO  = #{projectNo }
		ORDER BY COMM_NO DESC
	</select>
	<!-- 댓글 수정  -->
	<update id="updateReply"> UPDATE FUNDING_COMMENTS SET COMM_CONTENTS = #{contents }
		WHERE F_PROJECT_NO = #{no } AND COMM_NO = #{replyNo }
	</update>
	<!-- 댓글 삭제  -->
	<delete id="deleteReply"> DELETE FUNDING_COMMENTS WHERE F_PROJECT_NO =
		#{no } AND COMM_NO = #{replyNo }
	</delete>


	<!-- 신고하기 입력 -->
	<insert id="reportInsert" parameterType="FundingReport">
		INSERT INTO
		FUNDING_ACCUSATION
		VALUES(SEQ_FUND_ACCUSATION_NO.NEXTVAL,#{userId},#{reportCode},#{reportContent},DEFAULT,SYSDATE,#{projectNo})
	</insert>
		
		
			<!-- 좋아요 테이블에 좋아요 내역 추가 쿼리문 -->
	<insert id="insertProjectLike" parameterType="FundingLike">
		INSERT INTO
		FUNDING_LIKE
		VALUES(SEQ_FUND_LIKE_NO.NEXTVAL,#{userId},DEFAULT,#{projectNo})
	</insert>
		<!-- 펀딩 프로젝트 테이블에 있는 좋아요 컬럼 숫자 추가 업데이트. 위의 쿼리문과 동시 실행-->
	<update id="updateFundingProjectLikeCol" parameterType="Funding">
		UPDATE FUNDING_PROJECT SET LIKE_COUNT = LIKE_COUNT + 1
		WHERE
		F_PROJECT_NO = #{projectNo }
	</update>
	
	<!--좋아요 삭제 -->
	<delete id="deleteProjectLike" parameterType="FundingLike">
		 DELETE FUNDING_LIKE WHERE F_PROJECT_NO =
		#{projectNo } AND USER_ID = #{userId }
	</delete>
	
	 <!-- 좋아요 감소  -->
	<update id="updateFundingProjectLikeCol_Minus" parameterType="Funding">
		UPDATE FUNDING_PROJECT SET LIKE_COUNT = LIKE_COUNT - 1
		WHERE
		F_PROJECT_NO = #{projectNo }
	</update>


	
		 
		 <!-- 검색니뮤  -->
		
	<select id="selectSearchList_1" resultMap="fundingResultMap">
		SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
      	   	   PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
       			 FROM
			(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
			       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
			       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
			       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
			       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
			       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
			       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
			FROM FUNDING_PROJECT, FUNDING_FILE
			WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
			WHERE LEFT_DATE > 0 AND SUBJECT LIKE '%' || #{searchValue } || '%' AND PROJECT_CODE = 0
	</select>		 
		
		<select id="selectSearchList_2" resultMap="fundingResultMap">
		SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
      	   	   PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
       			 FROM
			(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
			       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
			       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
			       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
			       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
			       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
			       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
			FROM FUNDING_PROJECT, FUNDING_FILE
			WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
			WHERE LEFT_DATE<![CDATA[ <= ]]>0 AND SUBJECT LIKE '%' || #{searchValue } || '%' AND PROJECT_CODE = 0
	</select>		 
		
    
    
   
    
    <select id="selectListCountMy" resultType="_int">
		SELECT count(*) FROM DO_FUNDING LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    ON(F_PROJECT_NO = F_PROJECT_NO2) 
	    WHERE PROJECT_CODE = 0 AND CANCLE_YN = 0 AND DO_FUNDING.USER_ID = #{userId }
	</select>
	
	 <select id="selectListCountLike" resultType="_int">
       SELECT count(*) AS COUNT FROM FUNDING_LIKE LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    USING(F_PROJECT_NO) 
	    WHERE PROJECT_CODE = 0 AND FUNDING_LIKE.USER_ID = #{userId }
	</select>
	
	<select id="selectListCountProp" resultType="_int">
		  SELECT count(*) AS COUNT
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO)
WHERE PROJECT_CODE = 0 AND USER_ID = #{userId }
	</select>
	
	
	   <select id="calListNumberMyFunding" resultMap="FundingLogResultMap">
       SELECT count(*) AS COUNT FROM DO_FUNDING LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    ON(F_PROJECT_NO = F_PROJECT_NO2) 
	    WHERE PROJECT_CODE = 0 AND CANCLE_YN = 0 AND DO_FUNDING.USER_ID = #{userId }
	</select>	
	
	
	   <select id="selectMyFunding" resultMap="FundingLogResultMap">
        select a.*, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT, TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE from 
       (SELECT * FROM DO_FUNDING LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    ON(F_PROJECT_NO = F_PROJECT_NO2) 
	    WHERE PROJECT_CODE = 0 AND CANCLE_YN = 0 AND DO_FUNDING.USER_ID = #{userId } ORDER BY 1 DESC) a
	</select>	
	
	
	
	   <select id="selectMyFundingLike" resultMap="FundingLogResultMap">
        select a.*, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT, TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE from 
       (SELECT * FROM DO_FUNDING LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    ON(F_PROJECT_NO = F_PROJECT_NO2) 
	    WHERE PROJECT_CODE = 0 AND CANCLE_YN = 0 AND DO_FUNDING.USER_ID = #{userId } ORDER BY 24 DESC) a
	</select>	
	
	<select id="selectMyFundingMoney" resultMap="FundingLogResultMap">
        select a.*, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT, TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE from 
       (SELECT * FROM DO_FUNDING LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    ON(F_PROJECT_NO = F_PROJECT_NO2) 
	    WHERE PROJECT_CODE = 0 AND CANCLE_YN = 0 AND DO_FUNDING.USER_ID = #{userId } ORDER BY 16 DESC) a
	</select>	
    
    
     <select id="calListNumberLikeFunding" resultMap="FundingLikeResultMap">
       SELECT count(*) AS COUNT  FROM FUNDING_LIKE LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    USING(F_PROJECT_NO) 
	    WHERE PROJECT_CODE = 0 AND FUNDING_LIKE.USER_ID = #{userId }
	</select>	
	
	
	 <select id="selectLikeFunding" resultMap="FundingLikeResultMap">
        select a.*, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT, TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE from 
       (SELECT * FROM FUNDING_LIKE LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    USING(F_PROJECT_NO) 
	    WHERE PROJECT_CODE = 0 AND FUNDING_LIKE.USER_ID = #{userId } ORDER BY 2 DESC) a
	</select>	
	
	<select id="selectLikeFundingLike" resultMap="FundingLikeResultMap">
	      select a.*, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT, TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE from 
       (SELECT * FROM FUNDING_LIKE LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    USING(F_PROJECT_NO) 
	    WHERE PROJECT_CODE = 0 AND FUNDING_LIKE.USER_ID = #{userId } ORDER BY 17 DESC) a
	   </select>
	    
	  	 <select id="selectLikeFundingMoney" resultMap="FundingLikeResultMap">
         select a.*, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT, TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE from 
       (SELECT * FROM FUNDING_LIKE LEFT OUTER JOIN 
	    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
	    USING(F_PROJECT_NO) 
	    WHERE PROJECT_CODE = 0 AND FUNDING_LIKE.USER_ID = #{userId } ORDER BY 9 DESC) a
        </select>
    
    
   <select id="calListNumberProspFunding" resultMap="fundingResultMap">
  SELECT count(*) AS COUNT
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO)
WHERE PROJECT_CODE = 0 AND USER_ID = #{userId }
	</select>	
    
      <select id="selectPropFunding" resultMap="fundingResultMap">
  SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 1 DESC)
WHERE PROJECT_CODE = 0 AND USER_ID = #{userId }
	</select>	
    
        <select id="selectPropFundingLike" resultMap="fundingResultMap">
  SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 14 DESC)
WHERE PROJECT_CODE = 0 AND USER_ID = #{userId }
	</select>	
    
       <select id="selectPropFundingMoney" resultMap="fundingResultMap">
  SELECT F_PROJECT_NO,USER_ID,SUBJECT,PRODUCT_NAME,GOAL_MONEY,SUM_MONEY,OPTION_PRICE,OPTION_LIMIT,START_DATE,FIN_DATE,PROJ_STORY,PRODUCT_CONT,WARNING_INTRO,LIKE_COUNT,PROJECT_CODE,DELIVERY_DATE, 
       PERCENT,LEFT_DATE,FILE_NO,FILE_VIDEO_URL,FILE_MAIN_NAME,FILE_MAIN_SIZE,FILE_MAIN_PATH,FILE_SUB1_NAME,FILE_SUB1_SIZE,FILE_SUB1_PATH,FILE_SUB2_NAME,FILE_SUB2_SIZE,FILE_SUB2_PATH,UPLOAD_TIME
        FROM
(SELECT FUNDING_PROJECT.F_PROJECT_NO, FUNDING_PROJECT.USER_ID, FUNDING_PROJECT.SUBJECT, FUNDING_PROJECT.PRODUCT_NAME, FUNDING_PROJECT.GOAL_MONEY,
       FUNDING_PROJECT.SUM_MONEY, FUNDING_PROJECT.OPTION_PRICE, FUNDING_PROJECT.OPTION_LIMIT, FUNDING_PROJECT.START_DATE, FUNDING_PROJECT.FIN_DATE, 
       FUNDING_PROJECT.PROJ_STORY, FUNDING_PROJECT.PRODUCT_CONT, FUNDING_PROJECT.WARNING_INTRO, FUNDING_PROJECT.LIKE_COUNT, FUNDING_PROJECT.PROJECT_CODE,
       FUNDING_PROJECT.DELIVERY_DATE, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT,  TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE,
       FUNDING_FILE.FILE_NO, FUNDING_FILE.FILE_VIDEO_URL, FUNDING_FILE.FILE_MAIN_NAME, FUNDING_FILE.FILE_MAIN_SIZE, FUNDING_FILE.FILE_MAIN_PATH,
       FUNDING_FILE.FILE_SUB1_NAME, FUNDING_FILE.FILE_SUB1_SIZE, FUNDING_FILE.FILE_SUB1_PATH, FUNDING_FILE.FILE_SUB2_NAME, FUNDING_FILE.FILE_SUB2_SIZE,
       FUNDING_FILE.FILE_SUB2_PATH, FUNDING_FILE.UPLOAD_TIME
FROM FUNDING_PROJECT, FUNDING_FILE
WHERE FUNDING_PROJECT.F_PROJECT_NO = FUNDING_FILE.F_PROJECT_NO ORDER BY 6 DESC)
WHERE PROJECT_CODE = 0 AND USER_ID = #{userId }
	</select>	
    
    
       <select id="selectAllSponserList" resultMap="FundingLogResultMap">
    		 SELECT * FROM DO_FUNDING WHERE F_PROJECT_NO2 = #{userId } ORDER BY 1 DESC
    	 </select>
    
       <select id="selectOneProject" resultMap="FundingLogResultMap" parameterType="map">
  	select a.*, CEIL((SUM_MONEY / GOAL_MONEY)*100) AS PERCENT, TRUNC(FIN_DATE) - TRUNC(SYSDATE) AS LEFT_DATE from (SELECT * FROM DO_FUNDING LEFT OUTER JOIN 
    (SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO)) 
    ON(F_PROJECT_NO = F_PROJECT_NO2) 
    WHERE PROJECT_CODE = 0 AND CANCLE_YN = 0 AND DO_FUNDING.USER_ID = #{userId } AND F_PROJECT_NO = #{projectNo }) a
    	 </select>
    
    <update id="updateProjectLogCancel" parameterType="FundingLog">
		UPDATE DO_FUNDING
		SET CANCLE_YN = 1
		WHERE
		DOFUND_NO = #{doFundNo}
	</update>
	<update id="updateProject_SumMoneyMinus" parameterType="Funding">
		UPDATE FUNDING_PROJECT	
		SET SUM_MONEY = (SUM_MONEY - #{sumMoney})
		WHERE
		F_PROJECT_NO = #{projectNo}
	</update>
    
    
    
    <select id="selectOneProjectforModifty" resultMap="fundingResultMap">
    	SELECT * FROM FUNDING_PROJECT LEFT OUTER JOIN (FUNDING_FILE) USING(F_PROJECT_NO) WHERE PROJECT_CODE = 0 AND F_PROJECT_NO = #{projectNo}
    </select>
    
    
    	<update id="fundingPropUpdate_Porejct" parameterType="Funding">
    	UPDATE FUNDING_PROJECT SET
			SUBJECT = #{subjectName},
			PRODUCT_NAME = #{productName},
			GOAL_MONEY = #{goalMoney},
			OPTION_PRICE = #{optionPrice},
			OPTION_LIMIT = #{optionLimit},
			FIN_DATE = #{finDate},
			PROJ_STORY = #{projectStory},
			PRODUCT_CONT = #{productContent},
			WARNING_INTRO = #{warningIntro},
			DELIVERY_DATE = #{deleiveryDate}
			WHERE
		F_PROJECT_NO = #{projectNo}
    	</update>
    	<update id="fundingPropUpdate_File" parameterType="FundingFile">
    	UPDATE FUNDING_FILE SET
			FILE_VIDEO_URL = #{videoUrl},
			FILE_MAIN_NAME = #{fileMainName},
			FILE_SUB1_NAME = #{fileSub1Name},
			FILE_SUB2_NAME = #{fileSub2Name}
			WHERE
		F_PROJECT_NO = #{projectNo}
    	</update>
    
             <!--나혜님이 추가한거 -->
   <select id="selectAllList" resultMap="fundingResultMap">
      SELECT * FROM FUNDING_PROJECT
      WHERE PROJECT_CODE = 0
      ORDER BY F_PROJECT_NO DESC
   </select>
   
     <select id="selectFundingListCount" resultType="_int">
      SELECT COUNT(*) FROM FUNDING_PROJECT    WHERE PROJECT_CODE = 0
    </select>
    
    <update id="deleteAdminFunding" parameterType="_int">
       UPDATE FUNDING_PROJECT
       SET PROJECT_CODE = 1
       WHERE F_PROJECT_NO = #{projectNo}
    </update>
    
    <select id="selectFundingAccListCount" resultType="_int">
       SELECT COUNT(*) FROM FUNDING_ACCUSATION WHERE PROCESSING = 'N'
    </select>
    
    <select id="selectFundingAccList" resultMap="FundingReportResultMap">
       SELECT * FROM FUNDING_ACCUSATION WHERE PROCESSING = 'N' ORDER BY ACCU_FUND_NO DESC
    </select>
    
    <select id="selectOneFundingAcc" resultMap="FundingReportResultMap">
       SELECT * FROM FUNDING_ACCUSATION WHERE ACCU_FUND_NO = #{accuFundingNo} 
    </select>
    
    <update id="deleteFundingReport" parameterType="_int">
       UPDATE FUNDING_ACCUSATION SET PROCESSING = 'Y' WHERE F_PROJECT_NO=#{projectNo}
    </update>
    
    <update id="deleteFundingAcc" parameterType="_int">
       UPDATE FUNDING_PROJECT SET PROJECT_CODE = 1 WHERE F_PROJECT_NO=#{projectNo}
    </update>
    
    <select id="selectCountTodayRepor" resultType="_int">
       SELECT COUNT(*) FROM FUNDING_ACCUSATION WHERE TO_DATE(ACCUSATION_DATE, 'YY/MM/DD') = TO_DATE(SYSDATE, 'YY/MM/DD')
    </select>
    
    <select id="selectCountReport" resultMap="reportStatResultMap">
      SELECT DAY_LEVEL, DAY_NAME "REPORT_DAY", NVL(STAT_COUNT, 0) "REPORT_STAT_COUNT" FROM DAY_LEVEL LEFT JOIN (SELECT DAY, COUNT(*) "STAT_COUNT" FROM(
      SELECT TO_CHAR(ACCUSATION_DATE, 'D') "DAY_ORDER", CASE
      WHEN TO_CHAR(ACCUSATION_DATE, 'D') = '1' THEN '일'
      WHEN TO_CHAR(ACCUSATION_DATE, 'D') = '2' THEN '월'
      WHEN TO_CHAR(ACCUSATION_DATE, 'D') = '3' THEN '화'
      WHEN TO_CHAR(ACCUSATION_DATE, 'D') = '4' THEN '수'
      WHEN TO_CHAR(ACCUSATION_DATE, 'D') = '5' THEN '목'
      WHEN TO_CHAR(ACCUSATION_DATE, 'D') = '6' THEN '금'
      WHEN TO_CHAR(ACCUSATION_DATE, 'D') = '7' THEN '토'
      END "DAY"
      FROM FUNDING_ACCUSATION WHERE TO_CHAR(ACCUSATION_DATE) &gt;= TO_CHAR(SYSDATE-7,'YYYY-MM-DD') ORDER BY 1) GROUP BY DAY, DAY_ORDER ORDER BY DAY_ORDER ASC) ON DAY = DAY_NAME ORDER BY 1       
    </select>
    
</mapper>